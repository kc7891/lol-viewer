# Claude用コミット前チェックリスト

## 🚨 必須確認事項（コミット前に必ず全項目チェック）

### 1. テスト関連
- [ ] **テストコードを書いた**
  - 最小行数で網羅的なテストを作成
  - すべての新機能・変更をカバー
  - エラーケースもテスト
- [ ] **テストを実行して全てパスした**
  - `npm test` を実行
  - すべてのテストがパス (0 failed)
  - 新規追加テスト数を確認
- [ ] **テストカバレッジを確認した**
  - 新規追加コードがテストされている
  - APIコントラクト、IPC、統合テスト

### 2. ビルド関連
- [ ] **ビルドが成功した**
  - `npm run build` を実行
  - エラー・警告がない
  - dist/ディレクトリが正しく生成
- [ ] **パッケージングが成功した**
  - `npm run package` を実行
  - release/win-unpacked/が生成
  - 実行ファイル(.exe)が存在

### 3. 配布ファイル関連
- [ ] **ZIPファイルのサイズを確認した**
  - `ls -lh release/*.zip` でサイズ確認
  - **100MBを超える場合は分割必須**
  - 分割コマンド: `split -b 50M -d file.zip file.zip.part-`
- [ ] **ZIPファイルの配置を確認した**
  - releaseディレクトリに配置
  - 分割した場合はpart-00, part-01, part-02...
  - README.mdに結合方法を記載
- [ ] **.gitignoreを確認した**
  - 大きいZIPファイル本体は除外
  - 分割ファイルは含める
  - 不要なビルド成果物は除外

### 4. ドキュメント関連
- [ ] **README.mdを更新した**
  - 新機能の説明を追加
  - 使用方法を記載
  - 必要に応じてスクリーンショット
- [ ] **release/README.mdを更新した**
  - 分割ファイル名が正しい
  - 結合方法が最新
  - ファイルサイズが正確

### 5. コミット内容
- [ ] **必要最小限の変更**
  - 不要なファイルを含めていない
  - 関係ないコードを変更していない
  - フォーマット変更だけのコミットをしていない
- [ ] **コミットメッセージが明確**
  - 何を変更したか明記
  - なぜ変更したか説明
  - 技術的詳細を含める
- [ ] **git statusを確認した**
  - 意図したファイルのみステージング
  - 不要なファイルが含まれていない
  - node_modules/などが含まれていない

### 6. GitHub/Git関連
- [ ] **プッシュ前にファイルサイズチェック**
  - 100MB超えるファイルがないか確認
  - `git ls-files --stage | awk '$4 > 104857600'` で確認
  - 大きいファイルは事前に分割
- [ ] **コミット履歴がクリーン**
  - 不要なマージコミットがない
  - 修正コミットは squash 済み
  - コミットメッセージが読みやすい

### 7. ユーザー影響
- [ ] **動作確認者の時間を尊重**
  - テストで動作を事前に担保
  - 二度手間を発生させない
  - 完成度の高い状態でコミット
- [ ] **必要最小限の変更で最大の効果**
  - オーバーエンジニアリングしない
  - シンプルで理解しやすいコード
  - 保守性を考慮した実装

## 📋 過去のミスと対策

### ミス1: ZIPファイルサイズ超過
**問題**: 111MBのZIPファイルをコミット → GitHub制限(100MB)でプッシュ失敗
**対策**:
- コミット前に `ls -lh release/*.zip` で必ずサイズ確認
- 100MB超える場合は `split -b 50M` で分割
- 分割ファイル名は part-00, part-01, part-02...

### ミス2: テスト不足
**問題**: 機能追加後にテストを書かず、実行もせず
**対策**:
- 機能追加と同時にテストを書く
- コミット前に必ず `npm test` を実行
- テスト追加数をコミットメッセージに記載

### ミス3: .gitignoreの管理ミス
**問題**: ZIPファイルを除外設定したまま、必要なファイルが追加されない
**対策**:
- .gitignore編集時は必ずgit statusで確認
- 大きいZIP本体のみ除外、分割ファイルは含める
- コミット前に意図したファイルがステージングされているか確認

### ミス4: ドキュメント更新忘れ
**問題**: コード変更したがREADME更新を忘れる
**対策**:
- 新機能追加時は必ずREADME更新
- ファイル名変更時は関連ドキュメント全て更新
- release/README.mdも忘れずに確認

## ✅ コミット前の最終確認コマンド

```bash
# 1. テスト実行
npm test

# 2. ビルド確認
npm run build

# 3. ZIPサイズ確認
ls -lh release/*.zip 2>/dev/null || echo "No ZIP files"

# 4. 大きいファイルチェック (100MB超え)
find release -type f -size +100M 2>/dev/null || echo "No large files"

# 5. ステージング確認
git status

# 6. 差分確認
git diff --staged

# 7. コミット
git commit -m "明確なメッセージ"

# 8. プッシュ前の最終確認
git log -1 --stat

# 9. プッシュ
git push
```

## 💡 心構え

1. **動作確認者の時間は非常に貴重**
   - テストで事前に動作を担保する
   - 一度で完璧に仕上げる
   - 二度手間を絶対に避ける

2. **品質第一**
   - テストなしでコミットしない
   - ビルドエラーがある状態でコミットしない
   - 動作未確認でプッシュしない

3. **効率性**
   - 必要最小限の変更
   - 最大の効果を得る実装
   - シンプルで保守しやすいコード

4. **責任感**
   - 自分のミスは二度と繰り返さない
   - このチェックリストを毎回確認
   - ユーザーの時間を無駄にしない

---

**最終チェック**: このファイルを読み、すべての項目をチェックしてからコミット！
