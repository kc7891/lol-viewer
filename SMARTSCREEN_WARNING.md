# Windows SmartScreen 警告について

## 問題の説明

LoL Viewerを起動する際に、以下のようなWindows Defender SmartScreen警告が表示されることがあります：

```
Microsoft Defender SmartScreen は認識されないアプリの起動を停止しました。
このアプリを実行すると、PC が危険にさらされる可能性があります。
```

## 警告が表示される理由

この警告は、アプリケーションが**コード署名されていない**ために表示されます。コード署名には年間数万円のコストがかかる証明書が必要なため、個人開発のオープンソースプロジェクトでは通常実施されていません。

**このアプリケーションは安全です**。ソースコードは完全に公開されており、誰でも確認できます：
- GitHub: https://github.com/kc7891/lol-viewer

## 解決策

### 方法1: ユーザー側での対処（推奨・即座に解決）

警告画面で以下の手順を実行してください：

1. 「詳細情報」をクリック
2. 「実行する」ボタンをクリック

**これは1回だけの操作です**。一度実行を許可すれば、次回以降は警告が表示されません。

### 方法2: コード署名の実装（開発者側・完全な解決）

開発者がコード署名証明書を購入して署名することで、警告を完全に除去できます。

#### 必要なもの
- コード署名証明書（年間約3〜5万円）
  - 推奨プロバイダー：DigiCert, Sectigo, GlobalSign など

#### 実装済みの機能
このプロジェクトには既にコード署名のサポートが実装されています。証明書を取得した後、以下のGitHub Secretsを設定するだけで自動的に署名されます：

1. GitHubリポジトリの Settings > Secrets and variables > Actions に移動
2. 以下のシークレットを追加：
   - `CERTIFICATE_BASE64`: 証明書ファイル（.pfx）をBase64エンコードしたもの
   - `CERTIFICATE_PASSWORD`: 証明書のパスワード

**証明書のBase64エンコード方法（PowerShell）：**
```powershell
$bytes = [System.IO.File]::ReadAllBytes("path\to\certificate.pfx")
$base64 = [System.Convert]::ToBase64String($bytes)
$base64 | Out-File "certificate_base64.txt"
```

証明書を設定すると、GitHub Actionsビルド時に自動的に実行ファイルが署名され、SmartScreen警告が表示されなくなります。

### 方法3: SmartScreenレピュテーションの構築（長期的解決）

Microsoftは自動的にアプリケーションのレピュテーションを追跡しています：
- 多くのユーザーがアプリをダウンロードして実行
- セキュリティ問題が報告されない
- 時間の経過

これにより、コード署名なしでも警告が表示されなくなる可能性があります（数週間〜数ヶ月かかる場合があります）。

### 方法4: Pythonスクリプトとして実行

実行ファイルの代わりにPythonスクリプトとして直接実行することもできます：

```bash
# 必要なパッケージをインストール
pip install -r requirements.txt

# アプリケーションを実行
python main.py
```

この方法ではSmartScreen警告は表示されませんが、Pythonのインストールが必要です。

## 技術的な詳細

### 実装した改善策

1. **実行ファイルメタデータの追加** (`version_info.txt`)
   - 製品名、バージョン、著作権情報などを追加
   - これによりSmartScreenのレピュテーション構築が改善されます

2. **自動コード署名のサポート** (GitHub Actions)
   - 証明書が提供されている場合、ビルド時に自動的に署名
   - SHA256タイムスタンプ付き署名（最新の推奨方式）

3. **ユーザー向けドキュメント**
   - 配布パッケージにREADME.txtを含める
   - SmartScreen警告の対処法を明記

## よくある質問

**Q: このアプリは本当に安全ですか？**
A: はい、完全に安全です。ソースコードは公開されており、悪意のあるコードは含まれていません。

**Q: なぜ警告が表示されるのですか？**
A: コード署名証明書がないためです。証明書は高価なため、多くの個人開発プロジェクトでは使用されていません。

**Q: 毎回警告が表示されますか？**
A: いいえ、「実行する」を1回クリックすれば、以降は表示されません。

**Q: コード署名する予定はありますか？**
A: プロジェクトが成長し、十分な支援が得られれば検討します。現在は実装は完了しており、証明書の取得のみが必要です。

## 貢献について

コード署名証明書の購入を支援していただける場合、またはご質問がある場合は、GitHubのIssueでお知らせください。
